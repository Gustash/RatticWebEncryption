{% load i18n %}
{% load url from future %}

<h2>{% trans "Temporary Accesses" %}</h2>

<form id="RequestCheckSubmitForm" action="" method="post">{% csrf_token  %}
<input type='hidden' name='next' value=''>
<table class="table table-striped table-bordered table-condensed table-responsive-fourth-column table-responsive-fifth-column">
    <thead>
	<tr>
	    <td colspan="4">
		<button class="btn disabled rattic-check-enabled rattic-form-submit" data-target=".cred-list-check" data-action="{% url "cred.views.bulkrevoke" cred_id=cred.id %}">{%trans "Revoke Access" %}</button>
		<button class="btn disabled rattic-check-enabled rattic-form-submit" data-target=".cred-list-check" data-action="{% url "cred.views.bulkgrant" cred_id=cred.id %}">{% trans "Grant Access" %}</button>
	    </td>
	</tr>
	<tr>
 	    <th>
		<input type="checkbox" name="all" value="" class="rattic-checkall" data-target=".list-checktarget" />
	    </th>
	    <th>
		<a>{% trans "User" %}</a>
	    </th>
            <th>
                <a>{% trans "Request" %}</a>
            </th>
            <th>
                <a>{% trans "Access Granted" %}</a>
            </th>
            <th>
                <a>{% trans "Access Expired" %}</a>
            </th>
            <th>
                <a>{% trans "State" %}</a>
	</tr>
    </thead>
    <tbody>
	{% for tempcred in tempcreds %}
	    <tr>
		<td class="credcheck"><input type="checkbox" name="credcheck" value="{{ tempcred.id }}" class="list-checktarget cred-list-check" /></td>
		<td><a href={% url "staff.views.userdetail" tempcred.user.id  %}>{{ tempcred.user.username }}</a></td>
                <td>{{ tempcred.id }}</td>
                <td>{% if tempcred.date_granted != None %}{{ tempcred.date_granted  }}{% endif %}</td>
                <td>{{ tempcred.date_expired }}</td>
		{% if tempcred.state == state.PENDING %}
		    <td style="background-color:#FFFF00;">
			{% trans "Pending" %}
		    </td>
		{% elif tempcred.state == state.GRANTED %}
		    <td style="background-color:#00FF00;">
			{% trans "Granted" %}
		    </td>
		{% elif tempcred.state == state.REFUSED %}
		    <td style="background-color:#FF0000;">
			{% trans "Refused" %}
		    </td>
		{% elif tempcred.state == state.EXPIRED %}
		    <td style="background-color:#FF0000;">
			{% trans "Expired" %}
		    </td>
		{% endif %}
	    </tr>
	{% endfor %}
    </tbody>
</table>

</form>
